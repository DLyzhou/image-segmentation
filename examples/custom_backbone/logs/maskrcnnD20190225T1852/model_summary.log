__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_image (InputLayer)        (None, 1024, 1024, 3 0                                            
__________________________________________________________________________________________________
zero_padding2d_1 (ZeroPadding2D (None, 1030, 1030, 3 0           input_image[0][0]                
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 512, 512, 64) 9472        zero_padding2d_1[0][0]           
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 512, 512, 64) 256         conv1[0][0]                      
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 512, 512, 64) 0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 256, 256, 64) 0           activation_1[0][0]               
__________________________________________________________________________________________________
stage1_blocka_conv_2a (Conv2D)  (None, 256, 256, 64) 4160        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
stage1_blocka_bn_2a (BatchNorm) (None, 256, 256, 64) 256         stage1_blocka_conv_2a[0][0]      
__________________________________________________________________________________________________
stage1_blocka_relu_2a (Activati (None, 256, 256, 64) 0           stage1_blocka_bn_2a[0][0]        
__________________________________________________________________________________________________
stage1_blocka_conv_2b (Conv2D)  (None, 256, 256, 64) 36928       stage1_blocka_relu_2a[0][0]      
__________________________________________________________________________________________________
stage1_blocka_bn_2b (BatchNorm) (None, 256, 256, 64) 256         stage1_blocka_conv_2b[0][0]      
__________________________________________________________________________________________________
stage1_blocka_relu_2b (Activati (None, 256, 256, 64) 0           stage1_blocka_bn_2b[0][0]        
__________________________________________________________________________________________________
stage1_blocka_conv_2c (Conv2D)  (None, 256, 256, 256 16640       stage1_blocka_relu_2b[0][0]      
__________________________________________________________________________________________________
stage1_blocka_conv_1 (Conv2D)   (None, 256, 256, 256 16640       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
stage1_blocka_bn_2c (BatchNorm) (None, 256, 256, 256 1024        stage1_blocka_conv_2c[0][0]      
__________________________________________________________________________________________________
stage1_blocka_bn_1 (BatchNorm)  (None, 256, 256, 256 1024        stage1_blocka_conv_1[0][0]       
__________________________________________________________________________________________________
add_1 (Add)                     (None, 256, 256, 256 0           stage1_blocka_bn_2c[0][0]        
                                                                 stage1_blocka_bn_1[0][0]         
__________________________________________________________________________________________________
stage1_blocka_relu_out (Activat (None, 256, 256, 256 0           add_1[0][0]                      
__________________________________________________________________________________________________
stage1_blockb_conv_2a (Conv2D)  (None, 256, 256, 64) 16448       stage1_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage1_blockb_bn_2a (BatchNorm) (None, 256, 256, 64) 256         stage1_blockb_conv_2a[0][0]      
__________________________________________________________________________________________________
stage1_blockb_relu_2a (Activati (None, 256, 256, 64) 0           stage1_blockb_bn_2a[0][0]        
__________________________________________________________________________________________________
stage1_blockb_conv_2b (Conv2D)  (None, 256, 256, 64) 36928       stage1_blockb_relu_2a[0][0]      
__________________________________________________________________________________________________
stage1_blockb_bn_2b (BatchNorm) (None, 256, 256, 64) 256         stage1_blockb_conv_2b[0][0]      
__________________________________________________________________________________________________
stage1_blockb_relu_2b (Activati (None, 256, 256, 64) 0           stage1_blockb_bn_2b[0][0]        
__________________________________________________________________________________________________
stage1_blockb_conv_2c (Conv2D)  (None, 256, 256, 256 16640       stage1_blockb_relu_2b[0][0]      
__________________________________________________________________________________________________
stage1_blockb_bn_2c (BatchNorm) (None, 256, 256, 256 1024        stage1_blockb_conv_2c[0][0]      
__________________________________________________________________________________________________
add_2 (Add)                     (None, 256, 256, 256 0           stage1_blockb_bn_2c[0][0]        
                                                                 stage1_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage1_blockb_relu_2c (Activati (None, 256, 256, 256 0           add_2[0][0]                      
__________________________________________________________________________________________________
stage1_blockc_conv_2a (Conv2D)  (None, 256, 256, 64) 16448       stage1_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage1_blockc_bn_2a (BatchNorm) (None, 256, 256, 64) 256         stage1_blockc_conv_2a[0][0]      
__________________________________________________________________________________________________
stage1_blockc_relu_2a (Activati (None, 256, 256, 64) 0           stage1_blockc_bn_2a[0][0]        
__________________________________________________________________________________________________
stage1_blockc_conv_2b (Conv2D)  (None, 256, 256, 64) 36928       stage1_blockc_relu_2a[0][0]      
__________________________________________________________________________________________________
stage1_blockc_bn_2b (BatchNorm) (None, 256, 256, 64) 256         stage1_blockc_conv_2b[0][0]      
__________________________________________________________________________________________________
stage1_blockc_relu_2b (Activati (None, 256, 256, 64) 0           stage1_blockc_bn_2b[0][0]        
__________________________________________________________________________________________________
stage1_blockc_conv_2c (Conv2D)  (None, 256, 256, 256 16640       stage1_blockc_relu_2b[0][0]      
__________________________________________________________________________________________________
stage1_blockc_bn_2c (BatchNorm) (None, 256, 256, 256 1024        stage1_blockc_conv_2c[0][0]      
__________________________________________________________________________________________________
add_3 (Add)                     (None, 256, 256, 256 0           stage1_blockc_bn_2c[0][0]        
                                                                 stage1_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage1_blockc_relu_2c (Activati (None, 256, 256, 256 0           add_3[0][0]                      
__________________________________________________________________________________________________
stage2_blocka_conv_2a (Conv2D)  (None, 128, 128, 128 32896       stage1_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blocka_bn_2a (BatchNorm) (None, 128, 128, 128 512         stage2_blocka_conv_2a[0][0]      
__________________________________________________________________________________________________
stage2_blocka_relu_2a (Activati (None, 128, 128, 128 0           stage2_blocka_bn_2a[0][0]        
__________________________________________________________________________________________________
stage2_blocka_conv_2b (Conv2D)  (None, 128, 128, 128 147584      stage2_blocka_relu_2a[0][0]      
__________________________________________________________________________________________________
stage2_blocka_bn_2b (BatchNorm) (None, 128, 128, 128 512         stage2_blocka_conv_2b[0][0]      
__________________________________________________________________________________________________
stage2_blocka_relu_2b (Activati (None, 128, 128, 128 0           stage2_blocka_bn_2b[0][0]        
__________________________________________________________________________________________________
stage2_blocka_conv_2c (Conv2D)  (None, 128, 128, 512 66048       stage2_blocka_relu_2b[0][0]      
__________________________________________________________________________________________________
stage2_blocka_conv_1 (Conv2D)   (None, 128, 128, 512 131584      stage1_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blocka_bn_2c (BatchNorm) (None, 128, 128, 512 2048        stage2_blocka_conv_2c[0][0]      
__________________________________________________________________________________________________
stage2_blocka_bn_1 (BatchNorm)  (None, 128, 128, 512 2048        stage2_blocka_conv_1[0][0]       
__________________________________________________________________________________________________
add_4 (Add)                     (None, 128, 128, 512 0           stage2_blocka_bn_2c[0][0]        
                                                                 stage2_blocka_bn_1[0][0]         
__________________________________________________________________________________________________
stage2_blocka_relu_out (Activat (None, 128, 128, 512 0           add_4[0][0]                      
__________________________________________________________________________________________________
stage2_blockb_conv_2a (Conv2D)  (None, 128, 128, 128 65664       stage2_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage2_blockb_bn_2a (BatchNorm) (None, 128, 128, 128 512         stage2_blockb_conv_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockb_relu_2a (Activati (None, 128, 128, 128 0           stage2_blockb_bn_2a[0][0]        
__________________________________________________________________________________________________
stage2_blockb_conv_2b (Conv2D)  (None, 128, 128, 128 147584      stage2_blockb_relu_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockb_bn_2b (BatchNorm) (None, 128, 128, 128 512         stage2_blockb_conv_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockb_relu_2b (Activati (None, 128, 128, 128 0           stage2_blockb_bn_2b[0][0]        
__________________________________________________________________________________________________
stage2_blockb_conv_2c (Conv2D)  (None, 128, 128, 512 66048       stage2_blockb_relu_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockb_bn_2c (BatchNorm) (None, 128, 128, 512 2048        stage2_blockb_conv_2c[0][0]      
__________________________________________________________________________________________________
add_5 (Add)                     (None, 128, 128, 512 0           stage2_blockb_bn_2c[0][0]        
                                                                 stage2_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage2_blockb_relu_2c (Activati (None, 128, 128, 512 0           add_5[0][0]                      
__________________________________________________________________________________________________
stage2_blockc_conv_2a (Conv2D)  (None, 128, 128, 128 65664       stage2_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blockc_bn_2a (BatchNorm) (None, 128, 128, 128 512         stage2_blockc_conv_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockc_relu_2a (Activati (None, 128, 128, 128 0           stage2_blockc_bn_2a[0][0]        
__________________________________________________________________________________________________
stage2_blockc_conv_2b (Conv2D)  (None, 128, 128, 128 147584      stage2_blockc_relu_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockc_bn_2b (BatchNorm) (None, 128, 128, 128 512         stage2_blockc_conv_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockc_relu_2b (Activati (None, 128, 128, 128 0           stage2_blockc_bn_2b[0][0]        
__________________________________________________________________________________________________
stage2_blockc_conv_2c (Conv2D)  (None, 128, 128, 512 66048       stage2_blockc_relu_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockc_bn_2c (BatchNorm) (None, 128, 128, 512 2048        stage2_blockc_conv_2c[0][0]      
__________________________________________________________________________________________________
add_6 (Add)                     (None, 128, 128, 512 0           stage2_blockc_bn_2c[0][0]        
                                                                 stage2_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blockc_relu_2c (Activati (None, 128, 128, 512 0           add_6[0][0]                      
__________________________________________________________________________________________________
stage2_blockd_conv_2a (Conv2D)  (None, 128, 128, 128 65664       stage2_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blockd_bn_2a (BatchNorm) (None, 128, 128, 128 512         stage2_blockd_conv_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockd_relu_2a (Activati (None, 128, 128, 128 0           stage2_blockd_bn_2a[0][0]        
__________________________________________________________________________________________________
stage2_blockd_conv_2b (Conv2D)  (None, 128, 128, 128 147584      stage2_blockd_relu_2a[0][0]      
__________________________________________________________________________________________________
stage2_blockd_bn_2b (BatchNorm) (None, 128, 128, 128 512         stage2_blockd_conv_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockd_relu_2b (Activati (None, 128, 128, 128 0           stage2_blockd_bn_2b[0][0]        
__________________________________________________________________________________________________
stage2_blockd_conv_2c (Conv2D)  (None, 128, 128, 512 66048       stage2_blockd_relu_2b[0][0]      
__________________________________________________________________________________________________
stage2_blockd_bn_2c (BatchNorm) (None, 128, 128, 512 2048        stage2_blockd_conv_2c[0][0]      
__________________________________________________________________________________________________
add_7 (Add)                     (None, 128, 128, 512 0           stage2_blockd_bn_2c[0][0]        
                                                                 stage2_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage2_blockd_relu_2c (Activati (None, 128, 128, 512 0           add_7[0][0]                      
__________________________________________________________________________________________________
stage3_blocka_conv_2a (Conv2D)  (None, 64, 64, 256)  131328      stage2_blockd_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocka_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocka_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocka_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocka_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocka_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocka_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocka_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocka_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocka_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocka_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocka_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocka_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocka_conv_1 (Conv2D)   (None, 64, 64, 1024) 525312      stage2_blockd_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocka_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocka_conv_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocka_bn_1 (BatchNorm)  (None, 64, 64, 1024) 4096        stage3_blocka_conv_1[0][0]       
__________________________________________________________________________________________________
add_8 (Add)                     (None, 64, 64, 1024) 0           stage3_blocka_bn_2c[0][0]        
                                                                 stage3_blocka_bn_1[0][0]         
__________________________________________________________________________________________________
stage3_blocka_relu_out (Activat (None, 64, 64, 1024) 0           add_8[0][0]                      
__________________________________________________________________________________________________
stage3_blockb_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage3_blockb_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockb_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockb_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockb_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockb_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockb_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockb_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockb_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockb_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockb_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockb_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockb_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockb_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockb_conv_2c[0][0]      
__________________________________________________________________________________________________
add_9 (Add)                     (None, 64, 64, 1024) 0           stage3_blockb_bn_2c[0][0]        
                                                                 stage3_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage3_blockb_relu_2c (Activati (None, 64, 64, 1024) 0           add_9[0][0]                      
__________________________________________________________________________________________________
stage3_blockc_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockc_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockc_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockc_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockc_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockc_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockc_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockc_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockc_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockc_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockc_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockc_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockc_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockc_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockc_conv_2c[0][0]      
__________________________________________________________________________________________________
add_10 (Add)                    (None, 64, 64, 1024) 0           stage3_blockc_bn_2c[0][0]        
                                                                 stage3_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockc_relu_2c (Activati (None, 64, 64, 1024) 0           add_10[0][0]                     
__________________________________________________________________________________________________
stage3_blockd_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockd_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockd_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockd_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockd_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockd_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockd_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockd_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockd_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockd_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockd_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockd_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockd_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockd_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockd_conv_2c[0][0]      
__________________________________________________________________________________________________
add_11 (Add)                    (None, 64, 64, 1024) 0           stage3_blockd_bn_2c[0][0]        
                                                                 stage3_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockd_relu_2c (Activati (None, 64, 64, 1024) 0           add_11[0][0]                     
__________________________________________________________________________________________________
stage3_blocke_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockd_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocke_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocke_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocke_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocke_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocke_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocke_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocke_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocke_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocke_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocke_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocke_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocke_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocke_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocke_conv_2c[0][0]      
__________________________________________________________________________________________________
add_12 (Add)                    (None, 64, 64, 1024) 0           stage3_blocke_bn_2c[0][0]        
                                                                 stage3_blockd_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocke_relu_2c (Activati (None, 64, 64, 1024) 0           add_12[0][0]                     
__________________________________________________________________________________________________
stage3_blockf_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocke_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockf_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockf_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockf_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockf_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockf_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockf_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockf_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockf_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockf_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockf_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockf_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockf_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockf_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockf_conv_2c[0][0]      
__________________________________________________________________________________________________
add_13 (Add)                    (None, 64, 64, 1024) 0           stage3_blockf_bn_2c[0][0]        
                                                                 stage3_blocke_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockf_relu_2c (Activati (None, 64, 64, 1024) 0           add_13[0][0]                     
__________________________________________________________________________________________________
stage3_blockg_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockf_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockg_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockg_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockg_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockg_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockg_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockg_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockg_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockg_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockg_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockg_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockg_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockg_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockg_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockg_conv_2c[0][0]      
__________________________________________________________________________________________________
add_14 (Add)                    (None, 64, 64, 1024) 0           stage3_blockg_bn_2c[0][0]        
                                                                 stage3_blockf_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockg_relu_2c (Activati (None, 64, 64, 1024) 0           add_14[0][0]                     
__________________________________________________________________________________________________
stage3_blockh_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockg_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockh_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockh_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockh_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockh_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockh_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockh_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockh_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockh_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockh_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockh_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockh_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockh_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockh_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockh_conv_2c[0][0]      
__________________________________________________________________________________________________
add_15 (Add)                    (None, 64, 64, 1024) 0           stage3_blockh_bn_2c[0][0]        
                                                                 stage3_blockg_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockh_relu_2c (Activati (None, 64, 64, 1024) 0           add_15[0][0]                     
__________________________________________________________________________________________________
stage3_blocki_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockh_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocki_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocki_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocki_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocki_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocki_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocki_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocki_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocki_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocki_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocki_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocki_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocki_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocki_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocki_conv_2c[0][0]      
__________________________________________________________________________________________________
add_16 (Add)                    (None, 64, 64, 1024) 0           stage3_blocki_bn_2c[0][0]        
                                                                 stage3_blockh_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocki_relu_2c (Activati (None, 64, 64, 1024) 0           add_16[0][0]                     
__________________________________________________________________________________________________
stage3_blockj_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocki_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockj_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockj_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockj_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockj_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockj_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockj_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockj_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockj_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockj_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockj_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockj_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockj_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockj_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockj_conv_2c[0][0]      
__________________________________________________________________________________________________
add_17 (Add)                    (None, 64, 64, 1024) 0           stage3_blockj_bn_2c[0][0]        
                                                                 stage3_blocki_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockj_relu_2c (Activati (None, 64, 64, 1024) 0           add_17[0][0]                     
__________________________________________________________________________________________________
stage3_blockk_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockj_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockk_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockk_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockk_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockk_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockk_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockk_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockk_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockk_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockk_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockk_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockk_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockk_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockk_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockk_conv_2c[0][0]      
__________________________________________________________________________________________________
add_18 (Add)                    (None, 64, 64, 1024) 0           stage3_blockk_bn_2c[0][0]        
                                                                 stage3_blockj_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockk_relu_2c (Activati (None, 64, 64, 1024) 0           add_18[0][0]                     
__________________________________________________________________________________________________
stage3_blockl_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockk_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockl_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockl_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockl_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockl_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockl_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockl_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockl_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockl_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockl_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockl_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockl_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockl_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockl_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockl_conv_2c[0][0]      
__________________________________________________________________________________________________
add_19 (Add)                    (None, 64, 64, 1024) 0           stage3_blockl_bn_2c[0][0]        
                                                                 stage3_blockk_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockl_relu_2c (Activati (None, 64, 64, 1024) 0           add_19[0][0]                     
__________________________________________________________________________________________________
stage3_blockm_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockl_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockm_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockm_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockm_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockm_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockm_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockm_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockm_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockm_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockm_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockm_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockm_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockm_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockm_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockm_conv_2c[0][0]      
__________________________________________________________________________________________________
add_20 (Add)                    (None, 64, 64, 1024) 0           stage3_blockm_bn_2c[0][0]        
                                                                 stage3_blockl_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockm_relu_2c (Activati (None, 64, 64, 1024) 0           add_20[0][0]                     
__________________________________________________________________________________________________
stage3_blockn_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockm_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockn_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockn_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockn_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockn_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockn_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockn_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockn_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockn_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockn_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockn_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockn_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockn_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockn_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockn_conv_2c[0][0]      
__________________________________________________________________________________________________
add_21 (Add)                    (None, 64, 64, 1024) 0           stage3_blockn_bn_2c[0][0]        
                                                                 stage3_blockm_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockn_relu_2c (Activati (None, 64, 64, 1024) 0           add_21[0][0]                     
__________________________________________________________________________________________________
stage3_blocko_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockn_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocko_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocko_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocko_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocko_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocko_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocko_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocko_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocko_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocko_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocko_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocko_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocko_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocko_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocko_conv_2c[0][0]      
__________________________________________________________________________________________________
add_22 (Add)                    (None, 64, 64, 1024) 0           stage3_blocko_bn_2c[0][0]        
                                                                 stage3_blockn_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocko_relu_2c (Activati (None, 64, 64, 1024) 0           add_22[0][0]                     
__________________________________________________________________________________________________
stage3_blockp_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocko_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockp_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockp_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockp_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockp_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockp_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockp_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockp_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockp_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockp_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockp_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockp_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockp_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockp_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockp_conv_2c[0][0]      
__________________________________________________________________________________________________
add_23 (Add)                    (None, 64, 64, 1024) 0           stage3_blockp_bn_2c[0][0]        
                                                                 stage3_blocko_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockp_relu_2c (Activati (None, 64, 64, 1024) 0           add_23[0][0]                     
__________________________________________________________________________________________________
stage3_blockq_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockp_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockq_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockq_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockq_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockq_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockq_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockq_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockq_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockq_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockq_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockq_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockq_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockq_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockq_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockq_conv_2c[0][0]      
__________________________________________________________________________________________________
add_24 (Add)                    (None, 64, 64, 1024) 0           stage3_blockq_bn_2c[0][0]        
                                                                 stage3_blockp_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockq_relu_2c (Activati (None, 64, 64, 1024) 0           add_24[0][0]                     
__________________________________________________________________________________________________
stage3_blockr_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockq_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockr_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockr_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockr_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockr_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockr_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockr_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockr_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockr_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockr_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockr_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockr_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockr_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockr_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockr_conv_2c[0][0]      
__________________________________________________________________________________________________
add_25 (Add)                    (None, 64, 64, 1024) 0           stage3_blockr_bn_2c[0][0]        
                                                                 stage3_blockq_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockr_relu_2c (Activati (None, 64, 64, 1024) 0           add_25[0][0]                     
__________________________________________________________________________________________________
stage3_blocks_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockr_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocks_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocks_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocks_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocks_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocks_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocks_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocks_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocks_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocks_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocks_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocks_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocks_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocks_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocks_conv_2c[0][0]      
__________________________________________________________________________________________________
add_26 (Add)                    (None, 64, 64, 1024) 0           stage3_blocks_bn_2c[0][0]        
                                                                 stage3_blockr_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocks_relu_2c (Activati (None, 64, 64, 1024) 0           add_26[0][0]                     
__________________________________________________________________________________________________
stage3_blockt_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocks_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockt_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockt_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockt_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockt_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockt_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockt_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockt_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockt_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockt_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockt_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockt_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockt_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockt_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockt_conv_2c[0][0]      
__________________________________________________________________________________________________
add_27 (Add)                    (None, 64, 64, 1024) 0           stage3_blockt_bn_2c[0][0]        
                                                                 stage3_blocks_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockt_relu_2c (Activati (None, 64, 64, 1024) 0           add_27[0][0]                     
__________________________________________________________________________________________________
stage3_blocku_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockt_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocku_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocku_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocku_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blocku_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blocku_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blocku_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blocku_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blocku_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocku_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blocku_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blocku_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blocku_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blocku_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blocku_conv_2c[0][0]      
__________________________________________________________________________________________________
add_28 (Add)                    (None, 64, 64, 1024) 0           stage3_blocku_bn_2c[0][0]        
                                                                 stage3_blockt_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blocku_relu_2c (Activati (None, 64, 64, 1024) 0           add_28[0][0]                     
__________________________________________________________________________________________________
stage3_blockv_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blocku_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockv_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockv_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockv_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockv_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockv_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockv_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockv_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockv_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockv_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockv_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockv_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockv_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockv_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockv_conv_2c[0][0]      
__________________________________________________________________________________________________
add_29 (Add)                    (None, 64, 64, 1024) 0           stage3_blockv_bn_2c[0][0]        
                                                                 stage3_blocku_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockv_relu_2c (Activati (None, 64, 64, 1024) 0           add_29[0][0]                     
__________________________________________________________________________________________________
stage3_blockw_conv_2a (Conv2D)  (None, 64, 64, 256)  262400      stage3_blockv_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockw_bn_2a (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockw_conv_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockw_relu_2a (Activati (None, 64, 64, 256)  0           stage3_blockw_bn_2a[0][0]        
__________________________________________________________________________________________________
stage3_blockw_conv_2b (Conv2D)  (None, 64, 64, 256)  590080      stage3_blockw_relu_2a[0][0]      
__________________________________________________________________________________________________
stage3_blockw_bn_2b (BatchNorm) (None, 64, 64, 256)  1024        stage3_blockw_conv_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockw_relu_2b (Activati (None, 64, 64, 256)  0           stage3_blockw_bn_2b[0][0]        
__________________________________________________________________________________________________
stage3_blockw_conv_2c (Conv2D)  (None, 64, 64, 1024) 263168      stage3_blockw_relu_2b[0][0]      
__________________________________________________________________________________________________
stage3_blockw_bn_2c (BatchNorm) (None, 64, 64, 1024) 4096        stage3_blockw_conv_2c[0][0]      
__________________________________________________________________________________________________
add_30 (Add)                    (None, 64, 64, 1024) 0           stage3_blockw_bn_2c[0][0]        
                                                                 stage3_blockv_relu_2c[0][0]      
__________________________________________________________________________________________________
stage3_blockw_relu_2c (Activati (None, 64, 64, 1024) 0           add_30[0][0]                     
__________________________________________________________________________________________________
stage4_blocka_conv_2a (Conv2D)  (None, 32, 32, 512)  524800      stage3_blockw_relu_2c[0][0]      
__________________________________________________________________________________________________
stage4_blocka_bn_2a (BatchNorm) (None, 32, 32, 512)  2048        stage4_blocka_conv_2a[0][0]      
__________________________________________________________________________________________________
stage4_blocka_relu_2a (Activati (None, 32, 32, 512)  0           stage4_blocka_bn_2a[0][0]        
__________________________________________________________________________________________________
stage4_blocka_conv_2b (Conv2D)  (None, 32, 32, 512)  2359808     stage4_blocka_relu_2a[0][0]      
__________________________________________________________________________________________________
stage4_blocka_bn_2b (BatchNorm) (None, 32, 32, 512)  2048        stage4_blocka_conv_2b[0][0]      
__________________________________________________________________________________________________
stage4_blocka_relu_2b (Activati (None, 32, 32, 512)  0           stage4_blocka_bn_2b[0][0]        
__________________________________________________________________________________________________
stage4_blocka_conv_2c (Conv2D)  (None, 32, 32, 2048) 1050624     stage4_blocka_relu_2b[0][0]      
__________________________________________________________________________________________________
stage4_blocka_conv_1 (Conv2D)   (None, 32, 32, 2048) 2099200     stage3_blockw_relu_2c[0][0]      
__________________________________________________________________________________________________
stage4_blocka_bn_2c (BatchNorm) (None, 32, 32, 2048) 8192        stage4_blocka_conv_2c[0][0]      
__________________________________________________________________________________________________
stage4_blocka_bn_1 (BatchNorm)  (None, 32, 32, 2048) 8192        stage4_blocka_conv_1[0][0]       
__________________________________________________________________________________________________
add_31 (Add)                    (None, 32, 32, 2048) 0           stage4_blocka_bn_2c[0][0]        
                                                                 stage4_blocka_bn_1[0][0]         
__________________________________________________________________________________________________
stage4_blocka_relu_out (Activat (None, 32, 32, 2048) 0           add_31[0][0]                     
__________________________________________________________________________________________________
stage4_blockb_conv_2a (Conv2D)  (None, 32, 32, 512)  1049088     stage4_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage4_blockb_bn_2a (BatchNorm) (None, 32, 32, 512)  2048        stage4_blockb_conv_2a[0][0]      
__________________________________________________________________________________________________
stage4_blockb_relu_2a (Activati (None, 32, 32, 512)  0           stage4_blockb_bn_2a[0][0]        
__________________________________________________________________________________________________
stage4_blockb_conv_2b (Conv2D)  (None, 32, 32, 512)  2359808     stage4_blockb_relu_2a[0][0]      
__________________________________________________________________________________________________
stage4_blockb_bn_2b (BatchNorm) (None, 32, 32, 512)  2048        stage4_blockb_conv_2b[0][0]      
__________________________________________________________________________________________________
stage4_blockb_relu_2b (Activati (None, 32, 32, 512)  0           stage4_blockb_bn_2b[0][0]        
__________________________________________________________________________________________________
stage4_blockb_conv_2c (Conv2D)  (None, 32, 32, 2048) 1050624     stage4_blockb_relu_2b[0][0]      
__________________________________________________________________________________________________
stage4_blockb_bn_2c (BatchNorm) (None, 32, 32, 2048) 8192        stage4_blockb_conv_2c[0][0]      
__________________________________________________________________________________________________
add_32 (Add)                    (None, 32, 32, 2048) 0           stage4_blockb_bn_2c[0][0]        
                                                                 stage4_blocka_relu_out[0][0]     
__________________________________________________________________________________________________
stage4_blockb_relu_2c (Activati (None, 32, 32, 2048) 0           add_32[0][0]                     
__________________________________________________________________________________________________
stage4_blockc_conv_2a (Conv2D)  (None, 32, 32, 512)  1049088     stage4_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage4_blockc_bn_2a (BatchNorm) (None, 32, 32, 512)  2048        stage4_blockc_conv_2a[0][0]      
__________________________________________________________________________________________________
stage4_blockc_relu_2a (Activati (None, 32, 32, 512)  0           stage4_blockc_bn_2a[0][0]        
__________________________________________________________________________________________________
stage4_blockc_conv_2b (Conv2D)  (None, 32, 32, 512)  2359808     stage4_blockc_relu_2a[0][0]      
__________________________________________________________________________________________________
stage4_blockc_bn_2b (BatchNorm) (None, 32, 32, 512)  2048        stage4_blockc_conv_2b[0][0]      
__________________________________________________________________________________________________
stage4_blockc_relu_2b (Activati (None, 32, 32, 512)  0           stage4_blockc_bn_2b[0][0]        
__________________________________________________________________________________________________
stage4_blockc_conv_2c (Conv2D)  (None, 32, 32, 2048) 1050624     stage4_blockc_relu_2b[0][0]      
__________________________________________________________________________________________________
stage4_blockc_bn_2c (BatchNorm) (None, 32, 32, 2048) 8192        stage4_blockc_conv_2c[0][0]      
__________________________________________________________________________________________________
add_33 (Add)                    (None, 32, 32, 2048) 0           stage4_blockc_bn_2c[0][0]        
                                                                 stage4_blockb_relu_2c[0][0]      
__________________________________________________________________________________________________
stage4_blockc_relu_2c (Activati (None, 32, 32, 2048) 0           add_33[0][0]                     
__________________________________________________________________________________________________
fpn_c4p4 (Conv2D)               (None, 32, 32, 256)  524544      stage4_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
fpn_p4upsample (UpSampling2D)   (None, 64, 64, 256)  0           fpn_c4p4[0][0]                   
__________________________________________________________________________________________________
fpn_c3p3 (Conv2D)               (None, 64, 64, 256)  262400      stage3_blockw_relu_2c[0][0]      
__________________________________________________________________________________________________
fpn_p3add (Add)                 (None, 64, 64, 256)  0           fpn_p4upsample[0][0]             
                                                                 fpn_c3p3[0][0]                   
__________________________________________________________________________________________________
fpn_p3upsample (UpSampling2D)   (None, 128, 128, 256 0           fpn_p3add[0][0]                  
__________________________________________________________________________________________________
fpn_c2p2 (Conv2D)               (None, 128, 128, 256 131328      stage2_blockd_relu_2c[0][0]      
__________________________________________________________________________________________________
fpn_p2add (Add)                 (None, 128, 128, 256 0           fpn_p3upsample[0][0]             
                                                                 fpn_c2p2[0][0]                   
__________________________________________________________________________________________________
fpn_p2upsample (UpSampling2D)   (None, 256, 256, 256 0           fpn_p2add[0][0]                  
__________________________________________________________________________________________________
fpn_c1p1 (Conv2D)               (None, 256, 256, 256 65792       stage1_blockc_relu_2c[0][0]      
__________________________________________________________________________________________________
fpn_p1add (Add)                 (None, 256, 256, 256 0           fpn_p2upsample[0][0]             
                                                                 fpn_c1p1[0][0]                   
__________________________________________________________________________________________________
fpn_p4 (Conv2D)                 (None, 32, 32, 256)  590080      fpn_c4p4[0][0]                   
__________________________________________________________________________________________________
fpn_p1 (Conv2D)                 (None, 256, 256, 256 590080      fpn_p1add[0][0]                  
__________________________________________________________________________________________________
fpn_p2 (Conv2D)                 (None, 128, 128, 256 590080      fpn_p2add[0][0]                  
__________________________________________________________________________________________________
fpn_p3 (Conv2D)                 (None, 64, 64, 256)  590080      fpn_p3add[0][0]                  
__________________________________________________________________________________________________
fpn_p5 (MaxPooling2D)           (None, 16, 16, 256)  0           fpn_p4[0][0]                     
__________________________________________________________________________________________________
rpn_model (Model)               [(None, None, 2), (N 1189394     fpn_p1[0][0]                     
                                                                 fpn_p2[0][0]                     
                                                                 fpn_p3[0][0]                     
                                                                 fpn_p4[0][0]                     
                                                                 fpn_p5[0][0]                     
__________________________________________________________________________________________________
rpn_class (Concatenate)         (None, None, 2)      0           rpn_model[1][1]                  
                                                                 rpn_model[2][1]                  
                                                                 rpn_model[3][1]                  
                                                                 rpn_model[4][1]                  
                                                                 rpn_model[5][1]                  
__________________________________________________________________________________________________
rpn_bbox (Concatenate)          (None, None, 4)      0           rpn_model[1][2]                  
                                                                 rpn_model[2][2]                  
                                                                 rpn_model[3][2]                  
                                                                 rpn_model[4][2]                  
                                                                 rpn_model[5][2]                  
__________________________________________________________________________________________________
anchors (Lambda)                (1, 261888, 4)       0           input_image[0][0]                
__________________________________________________________________________________________________
input_gt_boxes (InputLayer)     (None, None, 4)      0                                            
__________________________________________________________________________________________________
ROI (ProposalLayer)             (None, 2000, 4)      0           rpn_class[0][0]                  
                                                                 rpn_bbox[0][0]                   
                                                                 anchors[0][0]                    
__________________________________________________________________________________________________
input_gt_class_ids (InputLayer) (None, None)         0                                            
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, None, 4)      0           input_gt_boxes[0][0]             
__________________________________________________________________________________________________
input_gt_masks (InputLayer)     (None, 56, 56, None) 0                                            
__________________________________________________________________________________________________
proposal_targets (DetectionTarg [(None, 200, 4), (No 0           ROI[0][0]                        
                                                                 input_gt_class_ids[0][0]         
                                                                 lambda_3[0][0]                   
                                                                 input_gt_masks[0][0]             
__________________________________________________________________________________________________
input_image_meta (InputLayer)   (None, 93)           0                                            
__________________________________________________________________________________________________
roi_align_mask (PyramidROIAlign (None, 200, 14, 14,  0           proposal_targets[0][0]           
                                                                 input_image_meta[0][0]           
                                                                 fpn_p1[0][0]                     
                                                                 fpn_p2[0][0]                     
                                                                 fpn_p3[0][0]                     
                                                                 fpn_p4[0][0]                     
__________________________________________________________________________________________________
mrcnn_mask_conv1 (TimeDistribut (None, 200, 14, 14,  590080      roi_align_mask[0][0]             
__________________________________________________________________________________________________
mrcnn_mask_bn1 (TimeDistributed (None, 200, 14, 14,  1024        mrcnn_mask_conv1[0][0]           
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 200, 14, 14,  0           mrcnn_mask_bn1[0][0]             
__________________________________________________________________________________________________
mrcnn_mask_conv2 (TimeDistribut (None, 200, 14, 14,  590080      activation_5[0][0]               
__________________________________________________________________________________________________
roi_align_classifier (PyramidRO (None, 200, 7, 7, 25 0           proposal_targets[0][0]           
                                                                 input_image_meta[0][0]           
                                                                 fpn_p1[0][0]                     
                                                                 fpn_p2[0][0]                     
                                                                 fpn_p3[0][0]                     
                                                                 fpn_p4[0][0]                     
__________________________________________________________________________________________________
mrcnn_mask_bn2 (TimeDistributed (None, 200, 14, 14,  1024        mrcnn_mask_conv2[0][0]           
__________________________________________________________________________________________________
mrcnn_class_conv1 (TimeDistribu (None, 200, 1, 1, 10 12846080    roi_align_classifier[0][0]       
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 200, 14, 14,  0           mrcnn_mask_bn2[0][0]             
__________________________________________________________________________________________________
mrcnn_class_bn1 (TimeDistribute (None, 200, 1, 1, 10 4096        mrcnn_class_conv1[0][0]          
__________________________________________________________________________________________________
mrcnn_mask_conv3 (TimeDistribut (None, 200, 14, 14,  590080      activation_6[0][0]               
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 200, 1, 1, 10 0           mrcnn_class_bn1[0][0]            
__________________________________________________________________________________________________
mrcnn_mask_bn3 (TimeDistributed (None, 200, 14, 14,  1024        mrcnn_mask_conv3[0][0]           
__________________________________________________________________________________________________
mrcnn_class_conv2 (TimeDistribu (None, 200, 1, 1, 10 1049600     activation_2[0][0]               
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 200, 14, 14,  0           mrcnn_mask_bn3[0][0]             
__________________________________________________________________________________________________
mrcnn_class_bn2 (TimeDistribute (None, 200, 1, 1, 10 4096        mrcnn_class_conv2[0][0]          
__________________________________________________________________________________________________
mrcnn_mask_conv4 (TimeDistribut (None, 200, 14, 14,  590080      activation_7[0][0]               
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 200, 1, 1, 10 0           mrcnn_class_bn2[0][0]            
__________________________________________________________________________________________________
mrcnn_mask_bn4 (TimeDistributed (None, 200, 14, 14,  1024        mrcnn_mask_conv4[0][0]           
__________________________________________________________________________________________________
pool_squeeze (Lambda)           (None, 200, 1024)    0           activation_3[0][0]               
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 200, 14, 14,  0           mrcnn_mask_bn4[0][0]             
__________________________________________________________________________________________________
mrcnn_bbox_fc (TimeDistributed) (None, 200, 324)     332100      pool_squeeze[0][0]               
__________________________________________________________________________________________________
mrcnn_mask_deconv (TimeDistribu (None, 200, 28, 28,  262400      activation_8[0][0]               
__________________________________________________________________________________________________
rpn_class_logits (Concatenate)  (None, None, 2)      0           rpn_model[1][0]                  
                                                                 rpn_model[2][0]                  
                                                                 rpn_model[3][0]                  
                                                                 rpn_model[4][0]                  
                                                                 rpn_model[5][0]                  
__________________________________________________________________________________________________
mrcnn_class_logits (TimeDistrib (None, 200, 81)      83025       pool_squeeze[0][0]               
__________________________________________________________________________________________________
mrcnn_bbox (Reshape)            (None, 200, 81, 4)   0           mrcnn_bbox_fc[0][0]              
__________________________________________________________________________________________________
mrcnn_mask (TimeDistributed)    (None, 200, 28, 28,  20817       mrcnn_mask_deconv[0][0]          
__________________________________________________________________________________________________
input_rpn_match (InputLayer)    (None, None, 1)      0                                            
__________________________________________________________________________________________________
input_rpn_bbox (InputLayer)     (None, None, 4)      0                                            
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 81)           0           input_image_meta[0][0]           
__________________________________________________________________________________________________
mrcnn_class (TimeDistributed)   (None, 200, 81)      0           mrcnn_class_logits[0][0]         
__________________________________________________________________________________________________
output_rois (Lambda)            (None, 200, 4)       0           proposal_targets[0][0]           
__________________________________________________________________________________________________
rpn_class_loss (Lambda)         ()                   0           input_rpn_match[0][0]            
                                                                 rpn_class_logits[0][0]           
__________________________________________________________________________________________________
rpn_bbox_loss (Lambda)          ()                   0           input_rpn_bbox[0][0]             
                                                                 input_rpn_match[0][0]            
                                                                 rpn_bbox[0][0]                   
__________________________________________________________________________________________________
mrcnn_class_loss (Lambda)       ()                   0           proposal_targets[0][1]           
                                                                 mrcnn_class_logits[0][0]         
                                                                 lambda_4[0][0]                   
__________________________________________________________________________________________________
mrcnn_bbox_loss (Lambda)        ()                   0           proposal_targets[0][2]           
                                                                 proposal_targets[0][1]           
                                                                 mrcnn_bbox[0][0]                 
__________________________________________________________________________________________________
mrcnn_mask_loss (Lambda)        ()                   0           proposal_targets[0][3]           
                                                                 proposal_targets[0][1]           
                                                                 mrcnn_mask[0][0]                 
==================================================================================================
Total params: 64,158,584
Trainable params: 64,047,096
Non-trainable params: 111,488
__________________________________________________________________________________________________
